
\subsection{Co-flow laminar diffusion flame}\label{ssec:coflowFlame}
%C:\Users\jfgj8\AppData\Local\BoSSS\plots\sessions\CoFlowFinal_Mult3__Full_CoFlowFlamerP4K12smoothfactor0velMult3LF1__5b10173f-65b1-484a-bfd9-1dc089c3571e
The co-flowing flame configuration is used as a first test to assess the behavior of the solver for reactive flows applications. It basically consists of two concentric ducts that emit fuel and oxidant into the system, creating a flame. This configuration has been widely studied. In the seminal work of \cite{burkeDiffusionFlames1928} analytical expressions for the flame height and flame shape are obtained by studying a very simplified problem (constant density and velocity field, infinitely fast chemistry, among others). Later, \cite{smookeNumericalModelingAxisymmetric1992} and later works solved this configuration using a 2D-axisymmetric system and also used the flame sheet estimates to find adequate initial conditions for their Newton algorithm. 
\begin{figure}[t]
	\centering
	\def\svgwidth{0.38\textwidth}
	\subcaptionbox{Sketch\label{fig:CoFlowSketch}}{
		\import{./plots/}{CoFlowSketch_withBC.pdf_tex}\vspace{0.5cm}
	}
	\qquad\quad
	\def\svgwidth{0.35\textwidth}
	\subcaptionbox{Refined mesh \label{fig:CoFlowMesh}}{
		\vspace{1.2cm}
		\import{./plots/}{CoFlowMesh.pdf_tex}
	}
	\caption{Geometry of a coflowing flame configuration (not to scale).} \label{fig:CoFlowGeometry}
\end{figure}
It should be noted that the solution of the axisymmetric system of equations presents numerical difficulties that are not the main concern of the present work. For this reason, it was decided to solve a system with similar characteristics but which is possible to represent in Cartesian coordinates. This is possible if an infinitely long slot burner is considered.
\subsubsection{Set-up of the slot coflowing flame configuration}
A schematic diagram of the configuration can be seen in \cref{fig:CoFlowSketch}, and consists of a fuel inlet with two oxygen inlets on its sides. Note that the system also includes the tips that separate both oxidizer and fuel inlets. The inclusion of this separation was seen to be necesary to be able to obtain a converged solution. Altought the system is clearly symmetric around the axis $x = 0$, no symmetry assumption is made and the whole domain is considered for the simulation. The lengths  depicted on \cref{fig:CoFlowSketch} are set as $r_1 = \SI{0.635}{\centi \meter}$, $r_2 = \SI{0.762}{\centi \meter}$, and $r_3 = \SI{7.747}{\centi \meter}$. Aditionally $h = \SI{2.54}{\centi \meter}$ and $H = \SI{40}{\centi \meter}$.  The lengths $r_3$ and $L$ are set with arbitrarily large values in order to avoid influence on the outer boundary conditions on the solution of the flame zone. Setting a higher value of $r_3$ or $L$ did not significantly affect the results.  %The thickness of the tips didnt seem to have an impact on the convergence behaviour of the algorithm.   sure?
The inlet boundary conditions are set as: 
\begin{itemize}
	\item Oxidizer inlet: $\{\forall (x,y): y = -R \land x \in [-X_3,-X_2]\cup[X_2,X_3]\}$\\
	\begin{equation*}
		u = 0,\qquad v= v_O, \qquad T = T^O, \qquad \vec{Y}' = (0,Y^O_{\ch{O2}},0,0)
	\end{equation*}
\item Fuel Inlet: $\{\forall (x,y): y = -R \land x \in [-X_1,X_1]\} $ \\
\begin{equation*}
	u = 0,\qquad v= v_F(x), \qquad T = T^F, \qquad \vec{Y}' = (Y^F_{\ch{CH4}},0,0,0)
\end{equation*}
%\item Pressure outlet  $\forall (x,y): y = -R \land x \in [-X_3,-X_2]\cup[X_2,X_3]$\\
%\item Adiabatic wall:
\end{itemize}
The oxidizer enters the system as a plug flow with a constant velocity of $v_O = \SI{4.1}{\centi \meter \per \second}$. The inlet velocity of the fluel stream $v_F$ is a a parabolic profile given by
\begin{equation}
	v_F(x) = \left[1-\left(\frac{x}{X_1}\right)^2\right]v_m^F
\end{equation}
with $v^F_m = \SI{2.427}{\centi \meter \per \second}$.  The inlet temperatures of both streams is  $T^F = T^O = \SI{300}{K}$. Combustion of diluted methane on air is considered, with $Y^F_{\ch{CH4}} = 0.2$, $Y^F_{\ch{N2}} = 0.8$, $Y^O_{\ch{O2}} = 0.23$ and $Y^O_{\ch{N2}} = 0.77$. The superindexes $F$ and $O$ represent the fuel and oxidizer inlet respectively. The pressure outlet boundary condition is the same as \cref{eq:bc_O}. Finally, the boundary conditions at the tips correspond to adiabatic walls, which are defined as in \cref{eq:bc_dn}, with $\vec{u}_{\text{D}} = (0,0)$.             

The variables are nondimensionalized in the usual way. The reference length $\RefVal{L} = \hat{r}_1$ and the reference velocity $\RefVal{u} =v^F_m$. The reference temperature is $\RefVal{T} = T^F$.  All derived variables are nondimensionalized using the air stream as a reference condition, i.e. $\RefVal{\rho} = \SI{1.17}{\kilo \gram \per \cubic \meter}$, $\RefVal{\mu} = \SI{1.85e-5}{\kilo \gram \per \meter \per \second}$,$\RefVal{W} = \SI{28.82}{\kilo \gram \per \kilo\mole}$. This gives the non-dimensional numbers $\Reynolds = 16.5$ $\text{Da} = 4.3\cdot 10^9$. The Prandtl number is assumed to be constant with $\Prandtl = 0.71$. The reference heat capacity is set $\hat{c}_{p,\text{ref}}= \SI{1.3}{\kilo \joule \per \kilo \gram \per \kelvin}$. Obviously the solution of a nondimensionalized system of equations should be independent of the reference values selected. Nevertheless, the choice of this value for the heat capacity is important because it gives a solution of the flame-sheet which is similar to the actual solution of the full problem. For this calculation, all Lewis numbers are set to unity. Gravity effects are not taken into account. The transport parameters are calculated using Sutherland law with $\hat{S} = \SI{110.5}{\kelvin}$. The mixture heat capacity $c_p$ is calculated with \cref{eq:nondim_cpmixture} and using NASA polynomials for the heat capacity of each component.

\subsubsection{Numerical results}
Numerical experiments using the XNSEC-solver showed that the solution of the problem is highly mesh-dependent. The presence of very high gradients in some areas of the problem requires a higher density of cells around these regions to obtain a well-resolved solution. For the solution of the coflow flame, a stretched base mesh is used, with smaller elements in the vicinity of the inlets and larger elements farther away from the inlets. It was observed that the complex mixing phenomena that occur in the vicinity of the inlets have a critical effect on the convergence of the solution. For this reason, a special refinement of the base mesh was necessary in the vicinity of the tips. 
Furthermore, an adequate mesh resolution on the areas where the flame is located is also critical. To avoid over-solving in zones where actually no reaction is taking place, an adaptive mesh refinement strategy in a pseudo-time-stepping framework was used (see \cref{ssec:MeshRefinement}). After obtaining a steady state solution, the mesh is refined and the calculation is started again. In particular, for this case, several pseudo-timesteps were performed for the flame-sheet calculation. After each of these, the mesh is refined in the vicinity of the flame sheet, i.e., in the cells where $z = z_{\text{st}}$. In \cref{fig:CoFlowMesh} the actual mesh used for the solution of the full problem is shown. Clearly, the mentioned refinement strategy works for the cases where the Lewis number corresponds to unity and the $c_p$ of the mixture has a constant value (assumptions made for the flame-sheet estimate). In case these conditions are not met, the solution obtained for the case with finite reaction rate will be slightly different from the flame-sheet solution.  However, experiments with the XNSEC-solver have shown that this refinement strategy is still beneficial for the convergence of the complete problem, but the selection of a good representative constant value for the heat capacity is important. 
% C:\Users\jfgj8\AppData\Local\BoSSS\plots\sessions\CoFlowFinal_Mult3__Full_CoFlowFlamerP4K12smoothfactor0velMult3LF1__5b10173f-65b1-484a-bfd9-1dc089c3571e
\begin{figure}[t!]
	\centering
	\pgfplotsset{
		compat=1.3,
		tick align = outside,
		yticklabel style={/pgf/number format/fixed},
	}
	\inputtikz{CoFlow_ConvergenceStory}
	\caption{Typical convergence history of a diffusion flame in the coflowing flame configuration.A mesh refinement was done at iteration 21. }
	\label{fig:CoFlow_ConvergenceStory}
\end{figure}

In \cref{fig:CoFlow_ConvergenceStory} the convergence history using the newton algorithm presented in \cref{sec:newton} is shown. The flame-sheet calculation requires 20 Newton iterations to find a solution. It is clearly seen how the residuals $\| \mathcal{A}(\myvector{U}_{n}) \|_2 $  for about the first 14 iterations decrease very slowly, while the $delta$ parameter of the globalized Newton method is adapted to find an optimal value to reduce the residuals. Around iteration 13 the algorithm starts to increase $delta$, obtaining a faster reduction of the residuals and the solution to the problem is found in iteration number 20. Then mesh refinement is used, and 6 iterations are required to find a converged solution. Finally, in iteration number 27 the flame-sheet solution is used as the initial estimate for the full problem, which requires only 11 iterations to find a solution. 

In \cref{fig:CoFlowFlameFig} solution fields of the coflow flame configuration are shown. Since for the selected inlet velocities the flame corresponds to a overventilated one, the typical jet form is observed. It can also clearly be seen from \cref{fig:CoFlowCH4} that all the fuel entering the system reacts with the oxygen. The exothermic reaction produces an acceleration on the flow field, as shown in  \cref{fig:CoFlowVelMag}
The maximum temperature reached corresponds to X (X Kelvin). %TODO

From this test case it is concluded that the strategy of using the flame-sheet as an initial condition presents an efficient way to obtain steady state solutions of combustion problems. Since the flame-sheet is only an estimate, it is possible to perform the calculations on relatively coarse grids, and use low order polynomial degrees. The obtained solution can be used as an estimate for calculations with higher polynomial degrees to find a more accurate solution of the full problem in a few iterations. A disadvantage, as already mentioned, is the choice of the $c_p$ parameter, since an inappropriate choice of it gives a solution of the flame-sheet problem far away from the solution of the full problem. However, the user's experience and access to experimental information allows estimating this value relatively easily. It is worth mentioning that the value chosen in this section ($\hat{c}_{p,\text{ref}}= \SI{1.3}{\kilo \joule \per \kilo \gram \per \kelvin}$)  served as an adequate estimate for all the simulations presented in this thesis.  


\begin{figure}[t]
	\centering
	\pgfplotsset{width=0.6\textwidth, compat=1.3}
	\inputtikz{CoFlowFlameFigTemperature}	
	\inputtikz{CoFlowFlameFigVelMag}	
	\par\bigskip
	\inputtikz{CoFlowFlameFigMF0}	
	\inputtikz{CoFlowFlameFigMF1}	
	\caption{Solution field of a coflow flame configuration.} \label{fig:CoFlowFlameFig}
\end{figure}

\FloatBarrier